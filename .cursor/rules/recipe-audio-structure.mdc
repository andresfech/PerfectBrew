# Recipe Audio Structure Rules

## üìã **Mandatory Recipe Structure**

Every recipe in PerfectBrew MUST follow this exact three-tier text structure:

### üéØ **1. Current Step Instruction (UI Display)**
- **Maximum**: 3 lines
- **Purpose**: Clean, concise instruction shown in the brewing interface
- **Format**: Direct, actionable steps
- **Example**: 
  ```text
  "Pour 40mL hot water in slow spiral.
  Start from center, work outward.
  Complete pour in 15 seconds."
  ```

### üîç **2. Short Description (Next Step Preview)**
- **Maximum**: 1 line
- **Purpose**: Brief preview of what comes next
- **Format**: Simple, anticipatory statement
- **Example**: `"Next: Wait for bloom to complete"`

### üéµ **3. Audio Script (TTS Generation)**
- **Purpose**: Rich, immersive narration that guides the user through time and technique.
- **CRITICAL**: Audio generation uses ONLY this text - no truncation, no rewriting.

#### ‚è±Ô∏è **Requirement A: Audible Time Cues**
Since users may not be looking at the screen, you MUST include verbal time cues. Vary the phrasing to avoid repetition:
- *"You have 10 seconds to complete this pour."*
- *"In 15 seconds, we will stir."*
- *"Aim to finish by the 30-second mark."*
- *"Take your time, you have 20 seconds."*
- *"Start pouring now. 10 seconds remaining."*

#### üéì **Requirement B: Educational & Engaging**
Explain **WHY** an action is taken. Use the available time to educate the user on the process:
- *"...this bloom releases CO2, which improves sweetness."*
- *"...pouring slowly ensures even saturation for a balanced cup."*
- *"...agitation here helps extract the fruity notes."*
- *"...the vacuum seal prevents dripping, keeping the temperature stable."*

#### ‚è≥ **Requirement C: Time Constraints (UX-Optimized)**
- **Strict Limit**: The spoken text MUST fit within the `time_seconds` allocated.
- **Rule of Thumb**: ~2.5 words per second.
- **UX Sweet Spot**: Fill 50-85% of allocated time for optimal user experience.
  - **<30%**: Too short - Insufficient guidance, feels rushed ‚ùå
  - **30-50%**: Acceptable but could use more content ‚ö†Ô∏è
  - **50-85%**: ‚úÖ **OPTIMAL** - Good balance, comfortable density
  - **85-95%**: Getting tight, consider trimming slightly ‚ö†Ô∏è
  - **>95%**: Too long - Risk of cutoff, overwhelming ‚ùå
- **Rationale**: Users need breathing room to process instructions. Filling 100% creates cognitive overload.
- **Priority**: If time is tight, prioritize the instruction and time cue over the educational content. Do NOT risk cutting off the audio.

### üìù **JSON Structure Example**
```json
{
  "time_seconds": 45,
  "instruction": "Pour 40mL hot water in slow spiral.\nStart from center, work outward.\nComplete pour in 15 seconds.",
  "short_instruction": "Next: Wait for bloom to complete",
  "audio_file_name": "brewing_step_01.m4a",
  "audio_script": "Start your timer. Pour 40 milliliters of hot water in a slow spiral. You have 15 seconds to complete this. This bloom phase releases carbon dioxide, preparing the bed for even extraction. Listen for the gentle fizz‚Äîthat's the gas escaping."
}
```

## üö® **Critical Rules**

1. **Audio Generation**: The TTS system uses EXACTLY the `audio_script` content.
2. **Time Constraints**: `audio_script` must be manually sized to fit `time_seconds`.
3. **No Truncation**: Never allow automatic truncation of audio content.
4. **Consistency**: All recipes must follow this structure without exception.
5. **Manual Validation**: Always verify audio script length matches step duration before generation.

## üéØ **Quality Standards**

- **Current Step**: Clear, actionable, concise.
- **Short Description**: Anticipatory, brief, helpful.
- **Audio Script**: 
    - ‚úÖ **Audible Time Cues** (Varied phrasing)
    - ‚úÖ **Educational Value** (Explain the "Why")
    - ‚úÖ **Perfectly Timed** (No cutoffs)
